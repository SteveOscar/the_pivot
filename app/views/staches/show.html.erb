<%= headshot_default_config(Rails.application.config.session_options[:key], headshot_capture_path) %>

<div class="row">
  <div class="col s12 m4">
    <div class="card white darken-1">
      <div class="card-content brown-text">
        <span class="card-title"><%= @stache.name %></span>
        <p><%= @stache.description %></p>
        <% unless @stache.categories.empty? %>
        Categories:
           <% @stache.categories.each do |category| %>
             <%= link_to category.title, category %>
           <% end %>
        <% end %>
      </div>
      <div class="card-action">
        <p><%= number_to_currency(@stache.price) %></p>
        <%= link_to("Add to Cart", cart_staches_path(stache_id: @stache.id),
        method: :post) unless @stache.retired? %>
      </div>
    </div>
  </div>

  <div class="col s12 m4">
    <div class="preview">
      <div class="card-image">
        <img src="<%= @stache.image_url %>">
      </div>
    </div>
  </div>

  <div class="col s12 m4 stache-me-box">
    <div class="preview">
      <div class="card-image">
        <div id="hideaway" style="display:none;">
        <img class="stache-me" src="<%= @stache.stache_url %>">
        </div>
        <div class="camera center-align row responsive-video">
          <%= headshot_camera(width = 400, height = 300) %>
        </div>
      </div>
      <div class="card-action">
        <a href="javascript:;" onClick="document.getElementById('hideaway').style.display='block';">Show Stache</a>
        <button class="capture row" id="myButton" type="submit" name="button" onclick="headshotHandlers.snap(); redirectTo('show_stache');">Take!</button>
        <br>
        <a href="javascript:;" onClick="document.getElementById('hideaway').style.display='none';">Hide Stache</a>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  function redirectTo(sUrl) {
    setTimeout (function () {
      window.location = sUrl
    }, 500);
  }
</script>